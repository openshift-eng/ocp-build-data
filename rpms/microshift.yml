# Disable automated build because it is intended to be built after a release is promoted.
mode: disabled
content:
  source:
    git:
      branch:
        target: release-{MAJOR}.{MINOR}
      url: git@github.com:openshift-priv/microshift.git
    specfile: packaging/rpm/microshift.spec
    modifications:
    - action: command
      command: microshift-rebase
      env:
        RELEASE_NAME: "{release_name}"
        # Since there's no lvms for 4.14 yet and microshift doesn't require a specific version
        # of lvms-operator-bundle, hardcode v4.12 for now.
        # # https://github.com/openshift/microshift/blob/main/docs/rebase.md#getting-release-image-build-references
        LVMS_OPERATOR_BUNDLE: registry.access.redhat.com/lvms4/lvms-operator-bundle:v4.12

name: microshift
targets:
- rhaos-{MAJOR}.{MINOR}-rhel-8-candidate
- rhaos-{MAJOR}.{MINOR}-rhel-9-candidate
hotfix_targets:
- rhaos-{MAJOR}.{MINOR}-rhel-8-hotfix
- rhaos-{MAJOR}.{MINOR}-rhel-9-hotfix
owners:
- microshift-devel@redhat.com
