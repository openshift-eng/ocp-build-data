---

####################################################################################################
#  STOP. HOLD. PLEASE WAIT. PLEASE READ. FAILURE TO READ WILL HAVE IMPACTS ACROSS THE ORGANIZATION.
####################################################################################################
# If you are about to modify this file, please know that the end result may be changing the
# base images for all upstream CI.
#
# ******IF you are about to bump ART's golang version******
# Please announce to aos-devel/aos-leads before doing so. Tell them when it will occur and
# hold to that schedule so that new CI issues can be correlated with the event.
#
# ******IF you are about to change an upstream_image name******
# Do so only if discussed with your team lead. This field does not impact ART builds.
# When this field is changed, it will open upstream PRs for each image using the stream
# in ART's ocp-build-data. i.e. if you change the upstream_image for golang, you will
# indirectly be responsible for openining >150 upstream PRs.
# Details: https://docs.google.com/document/d/1vTf_Ev_9iv_myWu7ClYLlsiN54rEDIblq-90n3sNscs/edit
#
####################################################################################################

# Used only to support hadoop-builder upstream builder image. Common tools used
# exclusively for testing are bundled on top of the golang builder image.
rhel-7-ci-build-root:
  image: not_applicable
  upstream_image_base: registry.ci.openshift.org/ocp/builder:rhel-7-golang-1.17-openshift-{MAJOR}.{MINOR}
  transform: rhel-7/ci-build-root
  upstream_image: registry.ci.openshift.org/openshift/release:rhel-7-release-openshift-{MAJOR}.{MINOR}

golang:
  # can be pulled from registry-proxy.engineering.redhat.com/rh-osbs/openshift-golang-builder@...
  # openshift-golang-builder-container-v1.17.5-202202101345.el8.gb1a57e0
  image: openshift/golang-builder@sha256:4820580c3368f320581eb9e32cf97aeec179a86c5749753a14ed76410a293d83
  mirror: true
  transform: rhel-8/golang
  upstream_image_base: registry.ci.openshift.org/ocp/builder:rhel-8-golang-1.17-openshift-{MAJOR}.{MINOR}.art
  # dptp will layer yum repos / extra packages on top of ART's image to create the
  # actual upstream_image. This is to allow upstream some extra helpers to build
  # tests that don't happen downstream.
  upstream_image: registry.ci.openshift.org/ocp/builder:rhel-8-golang-1.17-openshift-{MAJOR}.{MINOR}

golang-1.18:
  image: openshift/golang-builder@sha256:<wip>
  mirror: true
  transform: rhel-8/golang
  upstream_image_base: registry.ci.openshift.org/ocp/builder:rhel-8-golang-1.18-openshift-{MAJOR}.{MINOR}.art
  upstream_image: registry.ci.openshift.org/ocp/builder:rhel-8-golang-1.18-openshift-{MAJOR}.{MINOR}

rhel-8-golang-1.18-ci-build-root:
  image: not_applicable
  upstream_image_base: registry.ci.openshift.org/ocp/builder:rhel-8-golang-1.18-openshift-{MAJOR}.{MINOR}
  transform: rhel-8/ci-build-root
  upstream_image: registry.ci.openshift.org/openshift/release:rhel-8-release-golang-1.18-openshift-{MAJOR}.{MINOR}

# This is image is not used by ART. It is an artifact required in upstream CI to build unit tests.
# Our transform is designed to create a buildconfig atop a specific golang version, layering on
# packages that upstream has traditionally had present in its build_roots.
rhel-8-golang-ci-build-root:
  image: not_applicable
  upstream_image_base: registry.ci.openshift.org/ocp/builder:rhel-8-golang-1.17-openshift-{MAJOR}.{MINOR}
  transform: rhel-8/ci-build-root
  upstream_image: registry.ci.openshift.org/openshift/release:rhel-8-release-golang-1.17-openshift-{MAJOR}.{MINOR}

# IMPORTANT: etcd has unique approval to track its own etcd version. Other repos need arch
# approval to diverge from what kube apiserver uses for a given release.
# https://coreos.slack.com/archives/CB95J6R4N/p1598453188186800?thread_ts=1598449075.172000&cid=CB95J6R4N
etcd_golang:
  # openshift-golang-builder-container-v1.16.12-202202072221.el8.g92a7afd
  image: openshift/golang-builder@sha256:21aab8ec0f5d119e4f6dab12f7ad6a1cec15d5f9071ae0c7431be760f29d4c71
  mirror: true
  # No transform required as etcd does not yum install any packages.
  upstream_image_base: registry.ci.openshift.org/ocp/builder:rhel-8-etcd-golang-1.16
  upstream_image: registry.ci.openshift.org/ocp/builder:rhel-8-etcd-golang-1.16

# This image must only be used by -alt images, as this image cannot be built for aarch64.
rhel-7-golang:
  # openshift-golang-builder-container-v1.17.5-202202101345.el7.gf14244d
  image: openshift/golang-builder@sha256:aaf215825b2ac2e2bd80095c13bae1997ff78bd5488f0ead904d2105d9538300
  mirror: true
  upstream_image_base: registry.ci.openshift.org/ocp/builder:rhel-7-golang-1.17-openshift-{MAJOR}.{MINOR}.art
  # dptp will layer yum repos / extra packages on top of ART's image to create the
  # actual upstream_image. This is to allow upstream some extra helpers to build
  # tests that don't happen downstream.
  transform: rhel-7/golang
  upstream_image: registry.ci.openshift.org/ocp/builder:rhel-7-golang-1.17-openshift-{MAJOR}.{MINOR}

rhel8:
  # the most recent release at present. since we yum update this, maybe it does not need to float.
  # but it is important that we not build from unreleased builds.
  image: registry-proxy.engineering.redhat.com/rh-osbs/ubi8:8.5-236
  upstream_image: registry.ci.openshift.org/ocp/builder:rhel-8-openshift-{MAJOR}.{MINOR}.art
  mirror: true

nodejs:
  # the most recent release with precise nodejs 14 version we need.
  image: ubi8/nodejs-14:1-35.1626836507
  upstream_image: registry.ci.openshift.org/ocp/builder:rhel-8-openshift-nodejs-base-{MAJOR}.{MINOR}.art
  mirror: true
