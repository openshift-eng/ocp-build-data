arches:
- x86_64
content:
  source:
    dockerfile: Dockerfile.openshift
    git:
      branch:
        target: release-{MAJOR}.{MINOR}
      url: git@github.com:openshift-priv/alibaba-cloud-csi-driver.git
      web: https://github.com/openshift/alibaba-cloud-csi-driver
    ci_alignment:
      streams_prs:
        commit_prefix: "UPSTREAM: <carry>: "
        ci_build_root:
          stream: rhel-9-golang-ci-build-root
        auto_label:
        - approved
        - lgtm
    modifications:
      # Konflux build fails because it's building on detached mode (since it doesn't fetch the branch and just the commit)
      # https://github.com/openshift/alibaba-cloud-csi-driver/blob/master/build/build-all-amd.sh#L26
      - action: replace
        match: "RUN build/build-all-amd.sh noimage"
        replacement: "RUN git checkout -b rhaos-{MAJOR}.{MINOR}-rhel9 && build/build-all-amd.sh noimage"
distgit:
  branch: rhaos-{MAJOR}.{MINOR}-rhel-9
  component: ose-alibaba-cloud-csi-driver-container
enabled_repos:
- rhel-9-baseos-rpms
- rhel-9-appstream-rpms
for_payload: true
from:
  builder:
  - stream: rhel-9-golang
  member: openshift-enterprise-base-rhel9
name: openshift/ose-alibaba-cloud-csi-driver-container-rhel9
payload_name: alibaba-cloud-csi-driver
owners:
- aos-storage-staff@redhat.com
konflux:
  network_mode: open
