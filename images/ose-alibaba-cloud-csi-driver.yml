arches:
- x86_64
content:
  source:
    dockerfile: Dockerfile.openshift
    git:
      branch:
        target: release-{MAJOR}.{MINOR}
      url: git@github.com:openshift-priv/alibaba-cloud-csi-driver.git
      web: https://github.com/openshift/alibaba-cloud-csi-driver
    ci_alignment:
      streams_prs:
        ci_build_root:
          stream: rhel-8-golang-ci-build-root
        auto_label:
        - approved
        - lgtm
    modifications:
      # Konflux build fails because it's building on detached mode (since it doesn't fetch the branch and just the commit)
      # https://github.com/openshift/alibaba-cloud-csi-driver/blob/master/build/build-all-amd.sh#L26
      - action: replace
        match: "RUN build/build-all.sh noimage"
        replacement: "RUN git checkout -b rhaos-{MAJOR}.{MINOR}-rhel8 && build/build-all.sh noimage"
enabled_repos:
- rhel-8-baseos-rpms
- rhel-8-appstream-rpms
for_payload: true
from:
  builder:
  - stream: golang
  member: openshift-enterprise-base
name: openshift/ose-alibaba-cloud-csi-driver
owners:
- aos-storage-staff@redhat.com
konflux:
  network_mode: open
